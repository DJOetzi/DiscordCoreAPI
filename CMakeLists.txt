cmake_minimum_required(VERSION 3.1)
project(DiscordCoreAPI-Bot)

add_compile_definitions(DiscordCoreAPI-Bot)

add_executable(DiscordCoreAPI-Bot ${CMAKE_CURRENT_SOURCE_DIR}/main.cpp)

set(VcPkgFolder "C:/vcpkg/installed/x64-windows")
set(OpenSSLFolder "C:/OpenSSL")

add_link_options(/LTCG)
add_compile_options(/sdl)
add_compile_options(/Gm-)
add_compile_options(/Zi )
add_compile_options(/ZW:nostdlib)
add_compile_options(/Zc:wchar_t)
add_compile_options(/Gy)
add_compile_options(/W3)
add_compile_options(/GL)
add_compile_options(/GS)
add_compile_options(/MP)
add_compile_options(/bigobj)
include_directories(${CMAKE_SOURCE_DIR}/Headers/)

target_compile_definitions(DiscordCoreAPI-Bot PRIVATE $<$<CONFIG:Debug>:DEBUG_BUILD>)
target_compile_definitions(DiscordCoreAPI-Bot PRIVATE $<$<CONFIG:Release>:RELEASE_BUILD>)

set(ReleaseString <$CONFIG>:Release )
set(DebugString <$CONFIG>:Debug )

if (CMAKE_BUILD_CONFIGURATION STREQUAL "Release")
add_compile_options(/O2)
endif()

include_directories(${VcPkgFolder}/include)
include_directories(${VcPkgFolder}/lib/glib-2.0/include)
include_directories(${OpenSSLFolder}/include)

target_include_directories(DiscordCoreAPI-Bot PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/Headers/)
target_link_libraries(DiscordCoreAPI-Bot "${CMAKE_CURRENT_SOURCE_DIR}/Output Files/Release/DiscordCoreAPI-DLL.lib")
target_link_libraries(DiscordCoreAPI-Bot "${CMAKE_CURRENT_SOURCE_DIR}/Output Files/Debug/DiscordCoreAPI-DLL.lib")
target_link_libraries(DiscordCoreAPI-Bot ${VcPkgFolder}/lib/libcurl.lib)
target_link_libraries(DiscordCoreAPI-Bot ${VcPkgFolder}/lib/glib-2.0.lib)
target_link_libraries(DiscordCoreAPI-Bot ${VcPkgFolder}/lib/libsodium.lib)
target_link_libraries(DiscordCoreAPI-Bot ${VcPkgFolder}/lib/avutil.lib)
target_link_libraries(DiscordCoreAPI-Bot ${VcPkgFolder}/lib/avcodec.lib)
target_link_libraries(DiscordCoreAPI-Bot ${VcPkgFolder}/lib/swresample.lib)
target_link_libraries(DiscordCoreAPI-Bot ${VcPkgFolder}/lib/avformat.lib)
target_link_libraries(DiscordCoreAPI-Bot ${VcPkgFolder}/lib/opus.lib)
target_link_libraries(DiscordCoreAPI-Bot ${OpenSSLFolder}/libcrypto.lib)
target_link_libraries(DiscordCoreAPI-Bot ${OpenSSLFolder}/libssl.lib)
set_property(TARGET DiscordCoreAPI-Bot PROPERTY CXX_STANDARD 23)
file(COPY ${OpenSSLFolder}/libcrypto-3-x64.dll DESTINATION "${CMAKE_CURRENT_SOURCE_DIR}/Output Files/Release")
file(COPY ${OpenSSLFolder}/libssl-3-x64.dll DESTINATION "${CMAKE_CURRENT_SOURCE_DIR}/Output Files/Release")
file(COPY ${OpenSSLFolder}/libcrypto-3-x64.dll DESTINATION "${CMAKE_CURRENT_SOURCE_DIR}/Output Files/Debug")
file(COPY ${OpenSSLFolder}/libssl-3-x64.dll DESTINATION "${CMAKE_CURRENT_SOURCE_DIR}/Output Files/Debug")